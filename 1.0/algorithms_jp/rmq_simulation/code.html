<pre>
# Segment Tree for RQM
class RMQ:
    N    # 完全二分木のノード数
    n    # 列の要素数 = 葉の数
    minv # 最小値を保持する配列

    # 最低限必要な列の要素数で初期化
    init(len): 
        n &larr; 1
        while n < len:
            n &larr; n*2  # 葉の数nを2のべき乗にする
        N &larr; 2*n - 1  # 完全二分木のノード数を調整する 
        for i &larr; 0 to N-1:
            minv[i] &larr; INF

    findMin(a, b):
        return query(a, b, 0, 0, n)

    query(a, b, k, l, r):
        if r &le; a or b &le; l:
            res &larr; INF
        else if a &le; l and r &le; b:
            res &larr; minv[k]
        else:
            vl &larr; query(a, b, left(k), l, (l+r)/2)
            vr &larr; query(a, b, right(k), (l+r)/2, r)
            res &larr; min(vl, vr)

        return res

    # k番目の要素をxに書き換える
    update(k, x):
        k &larr; k + n - 1
        minv[k] &larr; x

        while  k &gt; 0:
            k &larr; parent(k)
            minv[k] &larr; min(minv[left(k)], minv[right(k)])

    left(k):
        return 2*k + 1

    right(k):
        return 2*k + 2

    parent(k):
        return (k - 1)/2
</pre>
